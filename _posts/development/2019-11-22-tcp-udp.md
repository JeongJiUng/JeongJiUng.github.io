---
date: 2019-11-22 01:10:00
layout: post
title: TCP와 UDP
subtitle: 통신 프로토콜
description: >-
  TCP와 UDP의 개념 및 특징
category: development
tags:
  - development
  - tcp
  - udp
  - server
  - network
author: Stop_Male
paginate: true
---

# TCP 프로토콜

## TCP

>  Transmision Control Protocol.
> 네트워크를 통해 순서가 있고 오류가 확인된 정보 패킷을 전달 및 수신하는 방법을 제공.

TCP는 연결형이고 승인을 제공하며 신뢰할 수 있는 다양한 기능을 갖춘 프로토콜로 안정적이지 않은 인터넷 프로토콜(IP) 위에서 애플리케이션이 안정적으로 데이터를 송신하는 방법을 제공한다.

애플리케이션이 데이터를 바이트 스트림으로 보낼 수 있도록 하며, 그 바이트 스트림을 적절한 크기의 세그먼트로 자동 패키징한다. TCP의 특수 슬라이딩 윈도우 체계는 수신자가 모든 데이터를 수신하고, 필요할 경우 재전송을 하며, 상대방의 송신 속도를 조절할 수 있는 흐름 제어 기능을 제공한다.

## TCP 구조

![image](https://github.com/JeongJiUng/jeongjiung.github.io/blob/master/_images/223C0D4957286ABC24.png?raw=true, tcp 구조)

**source port** : 패킷을 송신하는 시스템의 포트번호를 나타낸다. 클라이언트의 경우 예약된 0 ~ 1023의 well-known 포트 번호를 제외한 번호를 임의로 생성하고, 서버의 경우 일반적인 서비스 제공 시 well-known한 포트를 사용한다.

**destination port** : 패킷을 수신할 시스템의 포트번호를 나타낸다.

**sequence number** : 세그먼트(각 계층 패킷의 구분을 위해 4계층-세그먼트, 3계층-패킷, 2계층-프레임으로 구분) 데이터의 순서번호를 표기한다. 3Way-handshacking 수행 시 ISN의 기능도 한다.

**acknowledge number** : 상대방으로부터 수신한 데이터의 바로 다음에 수신할 데이터 순서번호를 나타낸다. sequence number의 확인 응답으로서 데이터 전송자에게 패킷을 잘 받았으니 그다음 패킷을 송신하라는 의미로 사용된다. 상대방이 다음에 전송할 패킷의 sequence number이기도 하다.

**header length** : TCP 헤더의 전체 길이를 byte 단위로 표현한다.

**reserved** : 미래를 위해 예약된 필드로 항상 0으로 설정.

**window size** : 송신 시스템에서 자신이 수용하는 한 버퍼의 크기를 byte 단위로 나타낸다. 통신하는 동안 송수신자는 해당 필드를 통해 수신사이즈를 계속 변경한다.

**checksum** : 데이터가 전송중에 손실되지 않고 원본과 동일한지 검사한다.

**urgent point** : urgent flag 설정 시 urgent 데이터의 마지막 byte의 일련번호를 urgent point 필드에 저장한다. 해당 부분까지 긴급하게 처리를 요한다는 의미이다.



## TCP의 기능

1. 주소지정 / 다중화
   * 여러 프로세스에서 온 데이터를 다중화하여 하위 네트워크 계층 프로토콜로 송신되도록 하는 것은 TCP의 중요한 임무이며 동시에 이들 상위 계층 애플리케이션은 TCP 포틀르 통해 식별된다.
2. 연결 수립, 유지, 종료
   * TCP는 장비가 데이터를 이동시킬 수 있는 연결을 협상하고 수립하기 위해 따라야 할 절차 모음을 제공한다. 연결이 수립되면 TCP는 연결을 유지하고 혹시 발생할 지 모르는 문제를 처리하기 위한 방법이 있다. 장비가 TCP 연결로 할 일을 마치면 그 연결을 종료하기 위한 특수한 절차도 수행한다.
3. 데이터 처리와 패키징
   * 애플리케이션이 상위 계층에서 데이터를 송신할 수 있는 방법을 제공한다. 이 데이터는 메시지로 패키징되고 목적지 TCP 소프트웨어로 전달된다.
4. 데이터 전송
   * 송신 장비의 TCP 구현은 패키징된 데이터를 다른 장비의 TCP 프로세스로 전달할 책임이 있다.
5. 신뢰성과 전송 품질 서비스 제공
   * 애플리케이션이 데이터를 신뢰할 수 있게 송신할 수 있도록 여러 서비스와 기능을 제공한다.
6. 흐름 제어와 혼잡 회피 기능 제공
   * 두 장비 간의 데이터 흐름을 제어하고 관리할 수 있도록 하며, 두 장비 간 통신에서 발생할 수 있는 혼잡을 처리하는 기능도 포함된다.

## TCP의 전송 제어 절차

### 흐름 제어

- 송신측이 수신측의 처리속도 보다 더 빨리 데이터를 보내지 못하도록 제어해 주는 것. 수신측에서 송신측 발송 데이터의 양이나 속도를 제한한다. (송신측을 억제하는 형태)
- 수신측에서 데이터 넘침을 송신측에 통보하는 피드백 메커니즘이 필요.
- 이를 속도조절(pacing) 이라고 한다.(송신, 수신의 속도를 일치시키는 것)

### 흐름제어 방식 구분

- 송신제어 방식 -> 정지대기 방식(stop and wait)
  * 한번에 1개씩 수신확인하며 프레임을 전송하는 방식
  * 링크상에서 보내고자하는 데이터가 프레임 길이 보다 긴 경우에는 비효율적.
- 전송률 기반 흐름제어 (rate-based)
  * 데이터 송신률에 대한 임계값 관리에 의한 흐름제어
- 윈오두 기반 흐름제어(window-based) -> sliding window
  * 여러 개의 프레임을 동시에 보내고자 하는 기법
  * 기타 윈도우 방식 : 크레디트 윈도우 방식, 페이징 윈도우 방식

### 전송 제어

- 데이터를 원활하게 전송하기 위하여 회선접속의 확인, 상대방의 확인, 데이터가 올바르게 전송되었는가의 확인 등을 하는 일련의 절차

### 전송 제어 특징

- 통신회선을 매개로 하여 데이터를 목적하는 장치에 착오없이 전송하기 위하여 송신장치와 수신장치간에 필요로 하는 절차.
- 전송제어절차 관련 제어 방식 : 데이터 링크
  * 데이터장치 제어 : 데이터 송수신에 관련된 장치의 지정이나 확인 -> 매체접근 제어
  * 데이터열의 제어 : 데이터 열을 논리적으로 구분(: farming) 또는 순서를 관리(: sequence number)
  * 에러 제어 : 전송중의 에러의 검출 및 정정

## TCP 프로토콜 특성

**연결형** : TCP는 장비가 데이터를 송신하기 전에 먼저 연결을 수립할 것을 요구.

**양방향** : 일단 연결이 수립되면 TCP 장비는 누가 연결을 초기화했는지에 관계없이 데이터를 양방향으로 송수신.

**다중 연결과 종단 식별** : 연결된 두 장비가 사용하는 소켓 쌍은 TCP 연결의 종단을 식별

**신뢰성** : TCP는 모든 데이터가 목적지에 도달할 수 있도록 송신, 수신한 데이터를 추적하기 떄문에 TCP 통신은 신뢰성 존재.

**승인** : 신뢰성을 제공하는데 핵심이 되는 특성은 TCP가 모든 정송에 대한 승인 메시지를 보낸다는 것.

**스트림 기반** : TCP는 애플리케이션이 연속적인 데이터 스트림을 송신할 수 있도록 함.

**구조화되지 않은 데이터** : TCP의 스트림 기반 특성때문에 애플리케이션은 메시지간 구별하는 방법을 제공해야 함.

**데이터흐름 관리** : TCP는 데이터가 일정한 속도로 평탄하게 흐르고, 전송 경로 중 발생하는 문제를 처리할 수 있도록 연결을 관리.

## TCP 프로토콜 요약

TCP는 인터넷에서 가장 일반적으로 사용되는 프로토콜이다. 브라우저에서 웹 페이지를 요청하면 컴퓨터는 TCP 패킷을 웹 서버로 전송하여 웹 페이지를 보여 달라고 요청을 한다. 웹 서버는 웹 페이지를 보여주기 위해 웹 브라우저에 TCP 패킷 스트림을 보내 응답한다. TCP는 전송된 패킷을 추적하여 전송 중에 데이터가 손실되거나 손상되지 않도록 한다. TCP는 먼저 번호를 매겨 패킷을 주문하고, 두 번째로 수신자가 보낸 사람에게 메시지를 받았음을 알리는 응답을 보내도록 하여 오류 검사를 수행한다. 만일 보낸 사람이 올바른 응답을 받지 못하였다면 받는 사람이 올바른 응답을 하도록 패킷을 다시 보낼 수도 있다.

# UDP 프로토콜

## UDP

> User Datagram Protocol. 비연결 지향형 서비스. 오류 검사를 제거하여 더 빠른 정보 흐름을 제공하기 위해 사용된다.

연결지향형인 TCP와는 달리 단순 오류검출 기능만을 지원하기 때문에 흐름제어나 오류제어등의 기능은 어플리케이션에서 담당해야만 한다. 이러한 이유로 UDP는 best-effort protocol로도 불린다.

UDP는 그 특성 때문에 다른 전송 프로토콜에 비해 오버헤드가 적고, 따라서 브로드캐스트나 멀티캐스트, 소량의 데이터 전송 시에는 UDP를 이용하는 것이 효율적이다.